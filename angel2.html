import React, { useState, useEffect } from 'react';
import { Sun, Moon, Sunrise, Bed, CheckCircle, Circle, Info, Pill, Droplet, Coffee, Utensils, Calendar, ShieldAlert, Repeat, Plane, Cookie, X, Milk, Clock, Ban, AlertTriangle, ThumbsUp, Activity } from 'lucide-react';

const SupplementApp = () => {
  const [activeTab, setActiveTab] = useState('two-meals');
  const [threeMealMode, setThreeMealMode] = useState('standard'); // 'standard' (Day 1-7) or 'gap' (Day 8-12)
  const [checkedItems, setCheckedItems] = useState({});
  const [progress, setProgress] = useState(0);
  const [showResetModal, setShowResetModal] = useState(false);

  // --- Data Definitions ---

  // 1. One Day Two Meals Schedule
  const scheduleDataTwoMeals = [
    {
      id: 'phase1',
      title: 'ç¬¬ä¸€éšæ®µï¼šèµ·åºŠç©ºè…¹',
      subtitle: 'é¤å‰ 30 åˆ†é˜',
      icon: <Sunrise className="w-5 h-5 text-orange-600" />, 
      color: 'bg-orange-100', 
      items: [
        { id: 'neocell', name: 'NeoCell Super Collagen', dose: '2 éŒ ', desc: 'çš®è†šèˆ‡é ­é«®çš„åœ°åŸº', type: 'pill' },
        { id: 'nmn', name: 'bard NMN 30000', dose: '1 é¡†', desc: 'å–šé†’ç´°èƒèˆ‡é«”åŠ›', type: 'pill' }
      ]
    },
    {
      id: 'phase2',
      title: 'ç¬¬äºŒéšæ®µï¼šç¬¬ä¸€é¤ (æ—©åˆé¤)',
      subtitle: 'å•Ÿå‹•ä»£è¬ãƒ»æç¥ãƒ»æ²¹é¡',
      note: 'èƒƒå£è¼ƒå¥½æ™‚æ”å–ï¼Œé©åˆååš¥å¤§é¡†è† å›Š',
      icon: <Sun className="w-5 h-5 text-amber-600" />,
      color: 'bg-amber-100',
      subSections: [
        {
          title: 'é£¯å‰å…ˆåƒ (ä¸¸é¡/ç²‰é¡)',
          items: [
            { id: 'profaes4', name: 'ProFaes4 ç›Šç”ŸèŒ', dose: '1 é¡†', desc: 'éš¨é¤ç¬¬ä¸€å£åƒï¼ŒåŠ©æ¶ˆåŒ–ã€æ¸›å°‘è„¹æ°£', type: 'pill' },
            { id: 'bkomplex', name: 'Mivolis B-Komplex (Bç¾¤)', dose: '1 é¡†', desc: 'æä¾›å·¥ä½œæ‰€éœ€èƒ½é‡', type: 'pill' },
            { id: 'beauty', name: 'Mivolis ç¾å®¹é…æ–¹ (Haut...)', dose: '1 éŒ ', desc: 'å«é‹…èˆ‡Q10ï¼Œç™½å¤©å¸æ”¶å¥½', type: 'pill' }
          ]
        },
        {
          title: 'é£¯ä¸­æˆ–é£¯å¾Œå (æ²¹é¡)',
          items: [
            { id: 'seal_oil', name: 'BioSunn Selolje æµ·è±¹æ²¹', dose: '1 é¡†', desc: 'Mounjaro é˜²èƒƒé£Ÿé“é€†æµï¼šæ²¹é¡è«‹åœ¨ç™½å¤©æ¶ˆåŒ–', type: 'oil' }
          ]
        }
      ]
    },
    {
      id: 'phase3',
      title: 'ç¬¬ä¸‰éšæ®µï¼šç¬¬äºŒé¤ (æ™šé¤)',
      subtitle: 'æŠ—æ°§åŒ–ãƒ»ä¿®å¾©ãƒ»é¿å…æ²¹è†©',
      // Converted to Array for multiple alerts
      prePhaseEvents: [
        {
          title: 'å¿«æ¨‚ä¸‹åˆèŒ¶ï¼æœæœèƒ½é‡ã€ä¹³æ¸…è›‹ç™½é£²ã€‘ï¼ˆåˆé¤å¾Œï¼’å°æ™‚ï¼‰',
          icon: <Coffee className="w-4 h-4 text-orange-600" />, // Added Icon for consistency
          note: 'å»ºè­°æ²–æ³¡ 350cc - 400cc çš„æ°´ï¼èŠ± 20-30 åˆ†é˜ æ…¢æ…¢å–å®Œ',
          colorTheme: 'orange'
        },
        {
          title: 'é£¢é¤“æ³•å¯¶ï¼æœæœèƒ½é‡ã€è›‹ç™½å¨åŒ–é…¥ã€‘ï¼ˆæ™šé¤å‰1.5å°æ™‚ï¼‰',
          icon: <Cookie className="w-4 h-4 text-orange-900" />,
          note: 'å»ºè­°æ­é… 350cc - 400cc çš„æ°´ï¼èŠ± 20-30 åˆ†é˜ æ…¢æ…¢åƒå®Œ',
          colorTheme: 'chestnut'
        }
      ],
      icon: <Utensils className="w-5 h-5 text-sky-600" />,
      color: 'bg-sky-100',
      items: [
        { id: 'vitc', name: 'Mivolis Vitamin C', dose: '1 é¡†', desc: 'ç·©é‡‹å‹ï¼Œå»¶çºŒå¤œé–“æŠ—æ°§åŒ–ä¿®å¾©', type: 'pill' },
        { id: 'blueberry', name: 'Nordmea BlÃ¥bÃ¦r è—è“', dose: '1 é¡†', desc: 'èˆ’ç·©æ•´å¤©ç”¨çœ¼ç–²å‹', type: 'pill' },
        { id: 'cartilage', name: 'BioSunn Haibrusk è»Ÿéª¨', dose: '2 é¡†', desc: 'å«éŠ…èˆ‡è»Ÿéª¨ç´  (èˆ‡æ—©ä¸Šçš„é‹…éŒ¯é–‹)', type: 'pill' }
      ]
    },
    {
      id: 'phase4',
      title: 'ç¬¬å››éšæ®µï¼šç¡å‰ (â°ï¼“ï¼ï¼ï¼–ï¼åˆ†é˜)',
      subtitle: 'è§£æ±ºä¾¿ç§˜èˆ‡ç¡çœ å•é¡Œ',
      prePhaseEvents: [
        {
          title: 'ğŸ’¡ é»ƒé‡‘æ™‚é–“ï¼šæ™šé¤è‡³ç¡å‰è‡³å°‘é–“éš” 2 å°æ™‚',
          colorTheme: 'amber'
        }
      ],
      icon: <Bed className="w-5 h-5 text-indigo-600" />,
      color: 'bg-indigo-100',
      items: [
        { id: 'magnesium', name: 'Mivolis Magnesium 500 é‚', dose: '1 éŒ ', desc: 'é—œéµï¼å¹«åŠ©æ’ä¾¿èˆ‡æ”¾é¬†è‚Œè‚‰', type: 'pill' },
        { id: 'calcium', name: 'Mivolis Calcium 600 éˆ£', dose: '1 éŒ ', desc: 'è£œéª¨ä¸¦ç©©å®šç¥ç¶“', type: 'pill' },
        { id: 'neocell_night', name: 'NeoCell Super Collagen', dose: '1 éŒ ', desc: 'åˆ†æ¬¡å¸æ”¶æ•ˆæœæ›´ä½³', type: 'pill' }
      ]
    }
  ];

  // 2. One Day Three Meals Schedule
  const getScheduleThreeMeals = (mode) => {
    const isGapMode = mode === 'gap';
    
    return [
      {
        id: 'tm_phase1',
        title: '1. èµ·åºŠç©ºè…¹ (æ—©é¤å‰ 30 åˆ†é˜)',
        subtitle: 'é˜²çš®é¬†é—œéµãƒ»å¸æ”¶æœ€ä½³',
        icon: <Sunrise className="w-5 h-5 text-orange-600" />,
        color: 'bg-orange-100',
        items: [
          { id: 'tm_neocell', name: 'NeoCell Super Collagen', dose: '2 éŒ ', desc: 'é˜²çš®é¬†æœ€é—œéµï¼Œç©ºè…¹å¸æ”¶æœ€ä½³', type: 'pill' },
          { id: 'tm_nmn', name: 'bard NMN 30000', dose: '1 é¡†', desc: 'å–šé†’ç´°èƒï¼Œè£œå……é«”åŠ›', type: 'pill' }
        ]
      },
      {
        id: 'tm_phase2',
        title: '2. æ—©é¤ (å•Ÿå‹•ä»£è¬)',
        subtitle: isGapMode ? 'ç©ºçª—æœŸé‡é»ï¼šå¢åŠ é£½è¶³æ„Ÿ' : 'é é˜²è„¹æ°£ãƒ»ç¶­æŒä»£è¬',
        icon: <Coffee className="w-5 h-5 text-amber-600" />,
        color: 'bg-amber-100',
        items: [
          { id: 'tm_profaes4', name: 'ProFaes4 ç›Šç”ŸèŒ', dose: '1 é¡†', desc: 'éš¨é¤ç¬¬ä¸€å£åƒï¼Œé é˜²æ•´å¤©çš„è„¹æ°£èˆ‡ä¾¿ç§˜', type: 'pill' },
          { id: 'tm_bkomplex', name: 'Mivolis B-Komplex (Bç¾¤)', dose: '1 é¡†', desc: 'æç¥ã€ç¶­æŒåŸºç¤ä»£è¬ï¼Œç™½å¤©åƒé¿å…å¤±çœ ', type: 'pill' },
          { id: 'tm_ampk', name: 'Life Extension AMPK', dose: '1 éŒ ', desc: 'ç‡ƒç‡’è…¹éƒ¨è„‚è‚ªï¼Œé…åˆè—¥ç‰©æ•ˆæœä½³', type: 'pill' },
          // Gap Mode Item
          ...(isGapMode ? [{ 
            id: 'tm_mct', 
            name: "Nature's Truth MCT Oil", 
            dose: '1 é¡†', 
            desc: 'â˜… ç©ºçª—æœŸåŠ å¼·ï¼šå¢åŠ é£½è¶³æ„Ÿï¼Œæ’éæ—©ä¸Šé£¢é¤“æ„Ÿ', 
            type: 'oil',
            highlight: true 
          }] : [])
        ]
      },
      {
        id: 'tm_phase3',
        title: '3. åˆé¤ (æ²¹è„‚æ¶ˆåŒ–+é¤Šé¡)',
        subtitle: 'è­·èƒƒãƒ»è­·çœ¼',
        icon: <Sun className="w-5 h-5 text-yellow-600" />,
        color: 'bg-yellow-100',
        items: [
          { id: 'tm_beauty', name: 'Mivolis ç¾å®¹é…æ–¹ (Haut+)', dose: '1 éŒ ', desc: 'å«é‹…ã€Q10ï¼Œéš¨é¤åƒè­·èƒƒä¸å™å¿ƒ', type: 'pill' },
          { id: 'tm_seal', name: 'BioSunn Selolje (æµ·è±¹æ²¹)', dose: '1 é¡†', desc: 'æ²¹é¡åˆé¤æ¶ˆåŒ–æœ€å¥½ï¼Œé¿å…å¤œé–“èƒƒé£Ÿé“é€†æµ', type: 'oil' },
          { id: 'tm_blueberry', name: 'Nordmea BlÃ¥bÃ¦r (è—è“)', dose: '1 é¡†', desc: 'è­·çœ¼ã€æŠ—æ°§åŒ–', type: 'pill' },
          // Gap Mode Item
          ...(isGapMode ? [{ 
            id: 'tm_mct_lunch', 
            name: "Nature's Truth MCT Oil", 
            dose: '1 é¡†', 
            desc: 'â˜… ç©ºçª—æœŸåŠ å¼·ï¼šå»¶çºŒé£½è¶³æ„Ÿè‡³ä¸‹åˆ', 
            type: 'oil',
            highlight: true 
          }] : [])
        ]
      },
      {
        id: 'tm_phase4',
        title: '4. æ™šé¤ (ä¿®å¾©+æŠ—æ°§åŒ–)',
        subtitle: 'å¤œé–“ä¿®å¾©ãƒ»é—œç¯€ä¿é¤Š',
        prePhaseEvents: [
          {
            title: 'å¿«æ¨‚ä¸‹åˆèŒ¶ï¼æœæœèƒ½é‡ã€ç´…éŸ»æ­è•¾ã€‘ï¼ˆåˆé¤å¾Œï¼’å°æ™‚ï¼‰',
            icon: <Coffee className="w-4 h-4 text-orange-600" />, // Added Icon for consistency
            note: 'å»ºè­°æ²–æ³¡ 350cc - 400cc çš„æ°´ï¼èŠ± 20-30 åˆ†é˜ æ…¢æ…¢å–å®Œ',
            colorTheme: 'orange'
          },
          {
            title: 'é£¢é¤“æ³•å¯¶ï¼æœæœèƒ½é‡ã€è›‹ç™½å¨åŒ–é…¥ã€‘ï¼ˆæ™šé¤å‰1.5å°æ™‚ï¼‰',
            icon: <Cookie className="w-4 h-4 text-orange-900" />, // Updated to chestnut theme
            note: 'å»ºè­°æ­é… 350cc - 400cc çš„æ°´ï¼èŠ± 20-30 åˆ†é˜ æ…¢æ…¢åƒå®Œ',
            colorTheme: 'chestnut' // Updated to chestnut theme
          }
        ],
        icon: <Utensils className="w-5 h-5 text-sky-600" />,
        color: 'bg-sky-100',
        note: isGapMode ? 'âš ï¸ ç©ºçª—æœŸèª¿æ•´ï¼šæ™šé¤æ¾±ç²‰è«‹æ¸›åŠï¼Œé¿å…è„‚è‚ªå †ç©' : null,
        noteType: isGapMode ? 'warning' : null,
        items: [
          { id: 'tm_vitc', name: 'Mivolis Vitamin C', dose: '1 é¡†', desc: 'å¹«åŠ©è»Ÿéª¨èˆ‡è† åŸè›‹ç™½åˆæˆï¼Œå¤œé–“æŠ—æ°§åŒ–', type: 'pill' },
          { id: 'tm_cartilage', name: 'BioSunn Haibrusk (é¯Šé­šè»Ÿéª¨)', dose: '2 é¡†', desc: 'å¤œé–“ä¿®å¾©é—œç¯€è»Ÿéª¨ï¼Œé é˜²é‹å‹•æå‚·', type: 'pill' }
        ]
      },
      {
        id: 'tm_phase5',
        title: '5. ç¡å‰ (â°ï¼“ï¼ï¼ï¼–ï¼åˆ†é˜)',
        subtitle: 'è§£æ±ºä¾¿ç§˜ãƒ»æ”¾é¬†åŠ©çœ ',
        prePhaseEvents: [
          {
            title: 'ğŸ’¡ é»ƒé‡‘æ™‚é–“ï¼šæ™šé¤è‡³ç¡å‰è‡³å°‘é–“éš” 2 å°æ™‚',
            colorTheme: 'amber'
          }
        ],
        icon: <Bed className="w-5 h-5 text-indigo-600" />,
        color: 'bg-indigo-100',
        items: [
          { id: 'tm_magnesium', name: 'Mivolis Magnesium 500 (é‚)', dose: '1 éŒ ', desc: 'é—œéµï¼è§£æ±ºä¾¿ç§˜ã€æ”¾é¬†è‚Œè‚‰ã€åŠ©çœ ', type: 'pill' },
          { id: 'tm_calcium', name: 'Mivolis Calcium 600 (éˆ£)', dose: '1 éŒ ', desc: 'è£œéˆ£ï¼Œèˆ‡é‚ä¸€èµ·ç©©å®šç¥ç¶“', type: 'pill' },
          { id: 'tm_neocell_night', name: 'NeoCell Super Collagen', dose: '1 éŒ ', desc: 'åˆ†æ¬¡å¸æ”¶ï¼Œå¤œé–“ä¿®å¾©', type: 'pill' }
        ]
      }
    ];
  };

  // 3. Alternatives Data
  const alternativesData = [
    {
      category: 'ç¡çœ èˆ‡æ’ä¾¿',
      icon: <Bed className="w-5 h-5 text-indigo-600" />,
      color: 'bg-indigo-50',
      primary: 'Mivolis Magnesium 500 (é‚)',
      alt: 'Natrol 5-HTP',
      note: 'é‚èƒ½è§£ä¾¿ç§˜+åŠ©çœ ã€‚è‹¥é‚åƒå®Œï¼Œæ”¹åƒ 5-HTP ç¶­æŒç¡çœ ã€‚'
    },
    {
      category: 'èƒ½é‡èˆ‡ä»£è¬',
      icon: <Coffee className="w-5 h-5 text-amber-600" />,
      color: 'bg-amber-50',
      primary: 'Mivolis B-Komplex (Bç¾¤)',
      alt: "Nature's Truth MCT Oil",
      note: <>æ‰“é‡æœŸé–“ B ç¾¤å„ªå…ˆã€‚MCT æ²¹æ˜“è…¹ç€‰ï¼Œå»ºè­°åƒ…åœ¨ <strong className="text-orange-600">å»¶å¾Œæ‰“é‡ (ç¬¬ 8-11 å¤©)</strong> æ™‚è£œå……é£½è¶³æ„Ÿã€‚</>
    },
    {
      category: 'å…ç–«èˆ‡é‹…',
      icon: <ShieldAlert className="w-5 h-5 text-rose-600" />,
      color: 'bg-rose-50',
      primary: 'Mivolis ç¾å®¹é…æ–¹ (Haut+)',
      alt: 'Mivolis Zink (å–®æ–¹é‹…)',
      note: 'ç¾å®¹é…æ–¹å«é‹…ä¸å‚·èƒƒã€‚å–®æ–¹é‹…åƒ…å»ºè­°æ„Ÿå†’æ™‚çŸ­æœŸè£œå……ã€‚'
    },
    {
      category: 'æ²¹è„‚/å¥³æ€§',
      icon: <Droplet className="w-5 h-5 text-sky-600" />,
      color: 'bg-sky-50',
      primary: 'BioSunn æµ·è±¹æ²¹',
      alt: 'äºå°¼æ´»åŠ› ç‰ç’ƒè‹£æ²¹',
      note: 'æµ·è±¹æ²¹ä»£è¬ä½³ã€‚ç‰ç’ƒè‹£æ²¹è‹¥é€ æˆæ‰“å—æœ‰æ²¹å‘³å¯æš«åœã€‚'
    }
  ];

  // Helper function for event styling
  const getEventStyles = (theme) => {
    switch (theme) {
      case 'orange':
        return {
          line: 'bg-orange-200/50 group-hover:bg-orange-300',
          capsule: 'bg-orange-50 border-orange-100 text-orange-700',
          note: 'text-orange-600'
        };
      case 'chestnut': // New Chestnut Theme
        return {
          line: 'bg-orange-300/50 group-hover:bg-orange-400',
          capsule: 'bg-orange-100 border-orange-200 text-orange-900', // Deep brown/chestnut text
          note: 'text-orange-800'
        };
      case 'stone':
        return {
          line: 'bg-stone-200/50 group-hover:bg-stone-300',
          capsule: 'bg-stone-50 border-stone-200 text-stone-700',
          note: 'text-stone-500'
        };
      case 'amber':
      default:
        return {
          line: 'bg-amber-200/50 group-hover:bg-amber-300',
          capsule: 'bg-amber-50 border-amber-100 text-amber-700',
          note: 'text-amber-600'
        };
    }
  };

  // --- Logic ---

  // Determine which dataset to use based on active tab
  const getCurrentScheduleData = () => {
    if (activeTab === 'two-meals') return scheduleDataTwoMeals;
    if (activeTab === 'three-meals') return getScheduleThreeMeals(threeMealMode);
    return [];
  };

  const currentSchedule = getCurrentScheduleData();

  // Calculate total items for progress bar
  const calculateTotalItems = () => {
    let count = 0;
    currentSchedule.forEach(phase => {
      if (phase.items) count += phase.items.length;
      if (phase.subSections) {
        phase.subSections.forEach(sub => count += sub.items.length);
      }
    });
    return count;
  };

  const totalItems = calculateTotalItems();

  // Load state
  useEffect(() => {
    const savedChecks = localStorage.getItem('mounjaro_daily_checks');
    const savedDate = localStorage.getItem('mounjaro_check_date');
    const today = new Date().toDateString();

    if (savedChecks && savedDate === today) {
      setCheckedItems(JSON.parse(savedChecks));
    } else {
      setCheckedItems({});
      localStorage.setItem('mounjaro_check_date', today);
    }
  }, []);

  // Update progress
  useEffect(() => {
    const currentIds = new Set();
    currentSchedule.forEach(phase => {
      if (phase.items) phase.items.forEach(i => currentIds.add(i.id));
      if (phase.subSections) phase.subSections.forEach(sub => sub.items.forEach(i => currentIds.add(i.id)));
    });

    const checkedCount = Object.keys(checkedItems).filter(id => checkedItems[id] && currentIds.has(id)).length;
    const percentage = totalItems > 0 ? Math.round((checkedCount / totalItems) * 100) : 0;
    
    setProgress(percentage);
    localStorage.setItem('mounjaro_daily_checks', JSON.stringify(checkedItems));
  }, [checkedItems, totalItems, activeTab, threeMealMode]);

  const toggleCheck = (id) => {
    setCheckedItems(prev => ({
      ...prev,
      [id]: !prev[id]
    }));
  };

  // Function to open the modal
  const handleResetClick = () => {
    setShowResetModal(true);
  };

  // Function to confirm reset
  const confirmReset = () => {
    setCheckedItems({});
    setProgress(0);
    setShowResetModal(false);
    localStorage.setItem('mounjaro_daily_checks', JSON.stringify({}));
  };

  // Component for individual supplement card
  const SupplementCard = ({ item }) => {
    const isChecked = checkedItems[item.id];
    
    return (
      <div 
        onClick={() => toggleCheck(item.id)}
        className={`relative p-4 mb-3 rounded-3xl border transition-all duration-300 cursor-pointer flex items-start gap-4
          ${isChecked 
            ? 'bg-teal-50/80 border-teal-200/60 shadow-none' 
            : item.highlight 
              ? 'bg-amber-50 border-amber-200 shadow-sm ring-1 ring-amber-100/50' 
              : 'bg-white border-slate-100 hover:border-teal-200 shadow-sm hover:shadow-md'}`}
      >
        <div className={`mt-0.5 transition-all duration-300 transform ${isChecked ? 'scale-110' : 'scale-100'}`}>
          {isChecked 
            ? <CheckCircle className="w-6 h-6 fill-teal-500 text-white" /> 
            : <Circle className="w-6 h-6 text-slate-300" />}
        </div>
        
        <div className="flex-1">
          <div className="flex justify-between items-start">
            <h3 className={`font-bold text-base sm:text-lg leading-tight tracking-normal transition-colors duration-300
              ${isChecked ? 'text-teal-800 line-through opacity-60' : 'text-slate-700'}`}>
              {item.name}
            </h3>
            <span className={`text-xs font-bold px-3 py-1.5 rounded-full whitespace-nowrap ml-2 transition-colors duration-300 tracking-wide
              ${isChecked ? 'bg-teal-100 text-teal-700 opacity-60' : 'bg-slate-100 text-slate-600'}`}>
              {item.dose}
            </span>
          </div>
          <p className={`text-sm font-medium mt-1.5 leading-relaxed transition-colors duration-300
            ${isChecked ? 'text-teal-700 opacity-60' : 'text-slate-500'}`}>
            {item.desc}
          </p>
          
          {/* Icon indicator for type - More subtle */}
          <div className="absolute top-3 right-3 opacity-5">
            {item.type === 'oil' ? <Droplet className="w-8 h-8" /> : <Pill className="w-8 h-8" />}
          </div>
        </div>
      </div>
    );
  };

  return (
    <>
    <style>{`
      @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
      .font-rounded {
        font-family: 'Nunito', 'Hiragino Maru Gothic ProN', 'Rounded Mplus 1c', 'Microsoft JhengHei', sans-serif;
      }
    `}</style>
    <div className="min-h-screen bg-slate-50 text-slate-800 font-rounded pb-24">
      {/* Header */}
      <div className="bg-white sticky top-0 z-50 shadow-sm/50 border-b border-slate-100 backdrop-blur-md bg-white/95">
        <div className="max-w-md mx-auto px-5 py-4">
          <div className="flex justify-between items-end mb-3">
            <div>
              <h1 className="text-2xl font-extrabold text-slate-800 tracking-wide">
                Angel <span className="font-medium text-xl text-slate-600">çš„å¥åº·ç§˜æ›¸</span>
              </h1>
              <p className="text-[10px] font-bold text-slate-400 mt-1 tracking-[0.2em] uppercase">
                {new Date().toLocaleDateString('zh-TW', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
              </p>
            </div>
            <div className="text-right">
              <div className="text-3xl font-black text-teal-500 leading-none">{progress}%</div>
              <div className="text-[10px] font-bold text-slate-300 uppercase tracking-[0.15em] mt-1">Daily Goal</div>
            </div>
          </div>
          
          {/* Progress Bar - Gradients */}
          <div className="h-3 w-full bg-slate-100 rounded-full overflow-hidden shadow-inner">
            <div 
              className="h-full bg-gradient-to-r from-teal-300 to-teal-500 shadow-[0_0_10px_rgba(20,184,166,0.5)] transition-all duration-700 ease-out rounded-full"
              style={{ width: `${progress}%` }}
            />
          </div>
        </div>

        {/* Tabs - Refined Segmented Control */}
        <div className="px-5 pb-4 pt-1">
          <div className="flex p-1.5 bg-slate-100/80 rounded-3xl w-full">
            <button 
              onClick={() => setActiveTab('two-meals')}
              className={`flex-1 py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2 px-1
                ${activeTab === 'two-meals' 
                  ? 'bg-white text-teal-600 shadow-sm ring-1 ring-black/5 scale-[1.02]' 
                  : 'text-slate-400 hover:text-slate-600 hover:bg-white/50'}`}
            >
              <Coffee className="w-3.5 h-3.5 sm:w-4 sm:h-4 shrink-0" />
              <span className="truncate">ä¸€æ—¥å…©é¤</span>
            </button>
            <button 
              onClick={() => setActiveTab('three-meals')}
              className={`flex-1 py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2 px-1
                ${activeTab === 'three-meals' 
                  ? 'bg-white text-teal-600 shadow-sm ring-1 ring-black/5 scale-[1.02]' 
                  : 'text-slate-400 hover:text-slate-600 hover:bg-white/50'}`}
            >
              <Plane className="w-3.5 h-3.5 sm:w-4 sm:h-4 shrink-0" />
              <span className="truncate">å‡ºåœ˜ç‰ˆ</span>
            </button>
            <button 
              onClick={() => setActiveTab('protein')}
              className={`flex-1 py-2 sm:py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2 px-1
                ${activeTab === 'protein' 
                  ? 'bg-white text-teal-600 shadow-sm ring-1 ring-black/5 scale-[1.02]' 
                  : 'text-slate-400 hover:text-slate-600 hover:bg-white/50'}`}
            >
              <Milk className="w-3.5 h-3.5 sm:w-4 sm:h-4 shrink-0" />
              <span className="text-center leading-tight">é«˜è›‹ç™½è£œå……å“</span>
            </button>
            <button 
              onClick={() => setActiveTab('alternatives')}
              className={`flex-1 py-2 sm:py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2 px-1
                ${activeTab === 'alternatives' 
                  ? 'bg-white text-teal-600 shadow-sm ring-1 ring-black/5 scale-[1.02]' 
                  : 'text-slate-400 hover:text-slate-600 hover:bg-white/50'}`}
            >
              <Pill className="w-3.5 h-3.5 sm:w-4 sm:h-4 shrink-0" />
              <span className="text-center leading-tight">æ›¿ä»£æ–¹æ¡ˆ</span>
            </button>
          </div>
        </div>
      </div>

      {/* Main Content Area */}
      <div className="max-w-md mx-auto p-5 space-y-8 animate-fade-in-up">
        
        {/* === ONE DAY TWO MEALS === */}
        {activeTab === 'two-meals' && (
          <div className="animate-fade-in">
            {/* Disclaimer for Mounjaro - Refined Style */}
            <div className="bg-gradient-to-br from-teal-50 to-white border border-teal-100/50 rounded-3xl p-5 flex gap-3 shadow-sm mb-6">
              <div className="bg-teal-100 p-2 rounded-full h-fit shrink-0">
                <Info className="w-5 h-5 text-teal-600" />
              </div>
              <div>
                <strong className="text-teal-800 text-sm block mb-1">Mounjaro ä½¿ç”¨è€…æç¤º</strong>
                <ul className="list-disc pl-4 space-y-1 text-xs text-teal-700/80 leading-relaxed font-medium">
                  <li>æµ·è±¹æ²¹ç­‰æ²¹é¡è«‹åœ¨ç™½å¤©æ”å–ï¼Œé¿å…å¤œé–“èƒƒé…¸å€’æµã€‚</li>
                  <li>ç¡å‰é‚éå¸¸é‡è¦ï¼Œæœ‰åŠ©æ–¼ç·©è§£è—¥ç‰©å¼•èµ·çš„ä¾¿ç§˜ã€‚</li>
                </ul>
              </div>
            </div>

            {currentSchedule.map((phase) => (
              <React.Fragment key={phase.id}>
                {/* Inter-phase Alerts (Dynamic Array) */}
                {phase.prePhaseEvents && phase.prePhaseEvents.map((event, idx) => {
                  const styles = getEventStyles(event.colorTheme);
                  return (
                    <div key={idx} className="flex items-center justify-center gap-3 my-6 group">
                      <div className={`h-px flex-1 transition-colors ${styles.line}`}></div>
                      
                      <div className={`flex flex-col items-center px-6 py-3 rounded-3xl border shadow-sm transition-all group-hover:shadow-md ${styles.capsule}`}>
                          
                          <div className="flex items-center gap-1.5">
                             {event.icon}
                             <span className="text-[13px] font-bold tracking-wide">{event.title}</span>
                          </div>

                          {event.note && (
                            <span className={`text-xs font-medium mt-1 opacity-90 ${styles.note}`}>
                               {event.note}
                            </span>
                          )}
                      </div>
                      
                      <div className={`h-px flex-1 transition-colors ${styles.line}`}></div>
                    </div>
                  );
                })}

                <div className="mb-6">
                  {/* Phase Header - New Design */}
                  <div className="flex items-center gap-3 mb-4 pl-1">
                    <div className={`p-3 rounded-2xl shadow-sm ${phase.color}`}>
                       {phase.icon}
                    </div>
                    <div>
                      <h2 className="font-bold text-lg text-slate-700 tracking-wide">{phase.title}</h2>
                      <p className="text-xs text-slate-500 font-medium tracking-wide">{phase.subtitle}</p>
                    </div>
                  </div>

                  {phase.note && (
                    <div className="bg-amber-50 text-amber-700 text-xs px-4 py-3 rounded-2xl mb-4 border border-amber-100/50 font-medium flex gap-2 items-center">
                      <span className="text-amber-500 text-lg">ğŸ’¡</span> {phase.note}
                    </div>
                  )}

                  {/* Standard List */}
                  {phase.items && phase.items.map(item => (
                    <SupplementCard key={item.id} item={item} />
                  ))}

                  {/* Subsections */}
                  {phase.subSections && phase.subSections.map((sub, idx) => (
                    <div key={idx} className="mt-5 pl-5 border-l-2 border-slate-100 ml-3">
                      <h3 className="text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider flex items-center gap-2">
                        <span className="w-1.5 h-1.5 rounded-full bg-slate-300"></span>
                        {sub.title}
                      </h3>
                      <div className="space-y-3">
                        {sub.items.map(item => (
                          <SupplementCard key={item.id} item={item} />
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              </React.Fragment>
            ))}
            
            <button 
              onClick={handleResetClick}
              className="w-full py-4 text-slate-400 text-sm font-medium hover:text-rose-500 transition-colors mt-8 flex items-center justify-center gap-2 hover:bg-rose-50 rounded-3xl"
            >
              <Repeat className="w-4 h-4" /> é‡ç½®ä»Šæ—¥ç´€éŒ„
            </button>
          </div>
        )}


        {/* === ONE DAY THREE MEALS === */}
        {activeTab === 'three-meals' && (
          <div className="animate-fade-in">
            
            {/* Mode Switcher - Refined */}
            <div className="flex p-1.5 bg-slate-200/50 rounded-3xl mb-6 border border-slate-100">
              <button
                onClick={() => setThreeMealMode('standard')}
                className={`flex-1 py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-2
                  ${threeMealMode === 'standard' 
                    ? 'bg-white text-teal-600 shadow-sm ring-1 ring-black/5' 
                    : 'text-slate-500 hover:text-slate-700 hover:bg-white/50'}`}
              >
                <Calendar className="w-4 h-4" /> ç¬¬ 1-7 å¤© (è—¥æ•ˆæœŸ)
              </button>
              <button
                onClick={() => setThreeMealMode('gap')}
                className={`flex-1 py-3 text-xs sm:text-sm font-bold tracking-wide rounded-2xl transition-all duration-300 flex items-center justify-center gap-2
                  ${threeMealMode === 'gap' 
                    ? 'bg-orange-50 text-orange-600 shadow-sm ring-1 ring-orange-200' 
                    : 'text-slate-500 hover:text-slate-700 hover:bg-white/50'}`}
              >
                <ShieldAlert className="w-4 h-4" /> ç¬¬ 8-12 å¤© (ç©ºçª—æœŸ)
              </button>
            </div>

            {/* Mode Info Header - Refined */}
            <div className={`rounded-3xl p-5 mb-6 text-sm border shadow-sm
              ${threeMealMode === 'standard' 
                ? 'bg-teal-50/50 border-teal-100 text-teal-900' 
                : 'bg-orange-50/50 border-orange-100 text-orange-900'}`}>
               <h3 className="font-bold flex items-center gap-2 mb-2 text-base tracking-wide">
                 {threeMealMode === 'standard' ? 'ğŸ“… å¹³æ—¥æ¨¡å¼é‡é»' : 'ğŸ›¡ï¸ ç©ºçª—æœŸ/å»¶å¾Œæ–½æ‰“æœŸé‡é»'}
               </h3>
               <p className="opacity-80 text-xs leading-relaxed font-medium">
                 {threeMealMode === 'standard' 
                   ? 'è­·èƒƒã€é˜²åã€è§£æ±ºä¾¿ç§˜ã€é é˜²è‚Œè‚‰æµå¤±ã€‚' 
                   : 'å¢åŠ é£½è¶³æ„Ÿã€æŠ‘åˆ¶é£Ÿæ…¾åæ’²ã€‚è—¥æ•ˆé€€å»æ™‚ï¼Œéœ€èª¿æ•´é£²é£Ÿç­–ç•¥ã€‚'}
               </p>
            </div>

            {currentSchedule.map((phase) => (
              <React.Fragment key={phase.id}>
                {/* Inter-phase Alerts (Dynamic Array) */}
                {phase.prePhaseEvents && phase.prePhaseEvents.map((event, idx) => {
                  const styles = getEventStyles(event.colorTheme);
                  return (
                    <div key={idx} className="flex items-center justify-center gap-3 my-6 group">
                      <div className={`h-px flex-1 transition-colors ${styles.line}`}></div>
                      
                      <div className={`flex flex-col items-center px-6 py-3 rounded-3xl border shadow-sm transition-all group-hover:shadow-md ${styles.capsule}`}>
                          
                          <div className="flex items-center gap-1.5">
                             {event.icon}
                             <span className="text-[13px] font-bold tracking-wide">{event.title}</span>
                          </div>

                          {event.note && (
                            <span className={`text-xs font-medium mt-1 opacity-90 ${styles.note}`}>
                               {event.note}
                            </span>
                          )}
                      </div>
                      
                      <div className={`h-px flex-1 transition-colors ${styles.line}`}></div>
                    </div>
                  );
                })}

                <div className="mb-6">
                   {/* Phase Header - New Design */}
                   <div className="flex items-center gap-3 mb-4 pl-1">
                    <div className={`p-3 rounded-2xl shadow-sm ${phase.color}`}>
                       {phase.icon}
                    </div>
                    <div>
                      <h2 className="font-bold text-lg text-slate-700 tracking-wide">{phase.title}</h2>
                      <p className="text-xs text-slate-500 font-medium tracking-wide">{phase.subtitle}</p>
                    </div>
                  </div>

                  {phase.note && (
                    <div className={`text-xs px-4 py-3 rounded-2xl mb-4 border font-bold flex gap-2 items-center
                      ${phase.noteType === 'warning' 
                        ? 'bg-rose-50 text-rose-700 border-rose-100' 
                        : 'bg-amber-50 text-amber-700 border-amber-100'}`}>
                      <span>{phase.noteType !== 'warning' ? 'ğŸ’¡' : 'âš ï¸'}</span>
                      {phase.note}
                    </div>
                  )}

                  {phase.items && phase.items.map(item => (
                    <SupplementCard key={item.id} item={item} />
                  ))}
                </div>
              </React.Fragment>
            ))}

            <button 
              onClick={handleResetClick}
              className="w-full py-4 text-slate-400 text-sm font-medium hover:text-rose-500 transition-colors mt-8 flex items-center justify-center gap-2 hover:bg-rose-50 rounded-3xl"
            >
              <Repeat className="w-4 h-4" /> é‡ç½®ä»Šæ—¥ç´€éŒ„
            </button>
          </div>
        )}

        {/* === PROTEIN SUPPLEMENT === */}
        {activeTab === 'protein' && (
          <div className="animate-fade-in space-y-6">
            
            {/* Product 1: Whey Protein */}
            <div className="bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm transition-all hover:shadow-md">
                {/* Header */}
                <div className="flex items-start gap-4 mb-5 pb-4 border-b border-amber-100">
                    <div className="p-3 bg-amber-100 rounded-2xl shrink-0">
                        <Coffee className="w-7 h-7 text-amber-900" />
                    </div>
                    <div>
                        <h3 className="text-lg font-bold text-slate-800 leading-tight">æœæœèƒ½é‡ï¼ä¹³æ¸…è›‹ç™½</h3>
                        <div className="mt-2 flex items-center gap-2 text-sm text-amber-900 bg-amber-100 px-3 py-1 rounded-xl w-fit font-bold">
                            <Clock className="w-4 h-4" /> æœ€ä½³æ™‚é–“ï¼šåˆé¤å¾Œ 2 å°æ™‚
                        </div>
                    </div>
                </div>

                <div className="space-y-4">
                    {/* Reason */}
                    <div className="text-sm text-slate-600 bg-slate-50 p-4 rounded-2xl leading-relaxed">
                        <span className="font-bold text-slate-700 block mb-1">ğŸ’¡ æ¨è–¦åŸå› ï¼š</span>
                        å–ä»£æ‰‹æ–é£²ï¼Œä¸”é¿é–‹æ­£é¤åè—¥æ™‚æ®µï¼Œæ¸›å°‘èƒƒéƒ¨è² æ“”ã€‚
                    </div>

                    {/* Alternatives */}
                    <div className="flex gap-3">
                        <div className="flex-1 bg-slate-50 p-3 rounded-2xl border border-slate-100">
                            <div className="flex items-center gap-1.5 mb-1.5 text-slate-400 font-bold text-xs uppercase tracking-wide">
                                <Sun className="w-3.5 h-3.5" /> æ›¿ä»£æ™‚æ©Ÿ 1
                            </div>
                            <div className="text-sm font-bold text-slate-700">æ—©é¤</div>
                            <div className="text-xs text-slate-500 mt-1">æ²’èƒƒå£åƒå›ºé«”é£Ÿç‰©æ™‚å¯ç›´æ¥å–ã€‚</div>
                        </div>
                        <div className="flex-1 bg-slate-50 p-3 rounded-2xl border border-slate-100">
                            <div className="flex items-center gap-1.5 mb-1.5 text-slate-400 font-bold text-xs uppercase tracking-wide">
                                <Activity className="w-3.5 h-3.5" /> æ›¿ä»£æ™‚æ©Ÿ 2
                            </div>
                            <div className="text-sm font-bold text-slate-700">é‹å‹•å¾Œ</div>
                            <div className="text-xs text-slate-500 mt-1">30åˆ†é˜å…§å–ï¼Œä¿®å¾©è‚Œè‚‰ã€‚</div>
                        </div>
                    </div>

                    {/* Warnings / Tips */}
                    <div className="bg-amber-50 border border-amber-100 rounded-2xl p-4">
                        <h4 className="flex items-center gap-2 font-bold text-amber-700 mb-3 text-sm">
                            <AlertTriangle className="w-4 h-4" /> çŒ›å¥æ¨‚ (Mounjaro) é‡é»å®åš€
                        </h4>
                        <ul className="space-y-2.5">
                            <li className="flex gap-3 text-xs text-amber-900/80 leading-relaxed">
                                <span className="bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded text-[10px] font-bold h-fit whitespace-nowrap">æ…¢é€Ÿé£²ç”¨</span>
                                è«‹èŠ± 20-30 åˆ†é˜ æ…¢æ…¢å–å®Œï¼Œä¸€å£æ°£çŒä¸‹å®¹æ˜“åã€‚
                            </li>
                            <li className="flex gap-3 text-xs text-amber-900/80 leading-relaxed">
                                <span className="bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded text-[10px] font-bold h-fit whitespace-nowrap">æ°´é‡åŠ å€</span>
                                å»ºè­°æ³¡ 350cc - 400ccï¼Œé †ä¾¿è£œæ°´ã€‚
                            </li>
                            <li className="flex gap-3 text-xs text-amber-900/80 leading-relaxed">
                                <span className="bg-rose-200 text-rose-800 px-1.5 py-0.5 rounded text-[10px] font-bold h-fit whitespace-nowrap">ç¡å‰ç¦å–</span>
                                é¿å…èƒƒé£Ÿé“é€†æµã€‚
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            {/* Product 2: Wafers */}
            <div className="bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm transition-all hover:shadow-md">
                {/* Header */}
                <div className="flex items-start gap-4 mb-5 pb-4 border-b border-amber-100">
                    <div className="p-3 bg-amber-100 rounded-2xl shrink-0">
                        <Cookie className="w-7 h-7 text-amber-900" />
                    </div>
                    <div>
                        <h3 className="text-lg font-bold text-slate-800 leading-tight">æœæœèƒ½é‡ï¼è›‹ç™½å¨åŒ–é¤…</h3>
                        <div className="mt-2 flex items-center gap-2 text-sm text-amber-900 bg-amber-100 px-3 py-1 rounded-xl w-fit font-bold">
                            <Clock className="w-4 h-4" /> æœ€ä½³æ™‚é–“ï¼šæ™šé¤å‰ 1.5 å°æ™‚
                        </div>
                    </div>
                </div>

                <div className="space-y-4">
                    {/* Reason */}
                    <div className="text-sm text-slate-600 bg-slate-50 p-4 rounded-2xl leading-relaxed">
                        <span className="font-bold text-slate-700 block mb-1">ğŸ’¡ æ¨è–¦åŸå› ï¼š</span>
                        ä½ç³–è§£é¥ï¼ŒMCT æ²¹å¹«åŠ©ä¸‹åˆæç¥ã€‚
                    </div>

                    {/* Alternative */}
                    <div className="bg-slate-50 p-3 rounded-2xl border border-slate-100 flex items-center gap-3">
                        <div className="p-2 bg-white rounded-xl shadow-sm text-slate-400">
                            <Activity className="w-4 h-4" />
                        </div>
                        <div className="text-xs text-slate-500">
                            <span className="font-bold text-slate-700 block mb-0.5">æ›¿ä»£æ–¹æ¡ˆ</span>
                            é‹å‹•å‰ 30-60 åˆ†é˜è£œå……èƒ½é‡ã€‚
                        </div>
                    </div>

                    {/* Danger Zone */}
                    <div className="bg-rose-50 border border-rose-100 rounded-2xl p-4">
                        <h4 className="flex items-center gap-2 font-bold text-rose-700 mb-2 text-sm">
                            <Ban className="w-4 h-4" /> è«‹å‹¿é£Ÿç”¨æ™‚é–“
                        </h4>
                        <div className="grid grid-cols-2 gap-3 mt-2">
                             <div className="bg-white/60 p-2 rounded-xl text-xs text-rose-900/80">
                                <span className="block font-bold mb-1">æ™šé¤å¾Œ/ç¡å‰</span>
                                MCT æ²¹å®¹æ˜“å°è‡´å¤œé–“ç«ç‡’å¿ƒã€‚
                             </div>
                             <div className="bg-white/60 p-2 rounded-xl text-xs text-rose-900/80">
                                <span className="block font-bold mb-1">æ­£é¤ç•¶ä¸‹</span>
                                æœƒå¤ªé£½åƒä¸ä¸‹æ­£é¤ï¼Œä¸”è›‹ç™½è³ªä¸è¶³ã€‚
                             </div>
                        </div>
                    </div>

                    {/* Warnings / Tips */}
                    <div className="bg-amber-50 border border-amber-100 rounded-2xl p-4">
                        <h4 className="flex items-center gap-2 font-bold text-amber-700 mb-3 text-sm">
                            <AlertTriangle className="w-4 h-4" /> çŒ›å¥æ¨‚ (Mounjaro) é‡é»å®åš€
                        </h4>
                        <ul className="space-y-2.5">
                            <li className="flex gap-3 text-xs text-amber-900/80 leading-relaxed">
                                <span className="bg-sky-200 text-sky-800 px-1.5 py-0.5 rounded text-[10px] font-bold h-fit whitespace-nowrap">å‹™å¿…é…æ°´</span>
                                é¤…ä¹¾è¼ƒä¹¾ï¼Œè«‹é… 200-300cc æ°´ ä¸€èµ·åƒï¼Œé¿å…å¡å–‰æˆ–ä¾¿ç§˜ã€‚
                            </li>
                            <li className="flex gap-3 text-xs text-amber-900/80 leading-relaxed">
                                <span className="bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded text-[10px] font-bold h-fit whitespace-nowrap">å°‘é‡æ¸¬è©¦</span>
                                è‹¥æ€• MCT æ²¹è…¹ç€‰ï¼Œç¬¬ä¸€æ¬¡å…ˆåƒåŠæ”¯è©¦è©¦ã€‚
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

          </div>
        )}


        {/* === ALTERNATIVES === */}
        {activeTab === 'alternatives' && (
          <div className="animate-fade-in space-y-4">
            <div className="bg-sky-50 text-sky-800 p-5 rounded-3xl border border-sky-100 mb-6 text-sm flex gap-3 shadow-sm">
               <div className="bg-sky-100 p-1.5 rounded-full h-fit shrink-0">
                  <Info className="w-4 h-4 text-sky-600" />
               </div>
               <p className="leading-relaxed opacity-90 font-medium">æ­¤æ¸…å–®æä¾›ç•¶é¦–é¸ç”¢å“ç¼ºè²¨ã€æˆ–èº«é«”ç‹€æ³æ”¹è®Šæ™‚çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
            </div>

            {alternativesData.map((alt, index) => (
              <div key={index} className="bg-white p-5 rounded-3xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow">
                 <div className="flex items-center gap-3 mb-4 pb-3 border-b border-slate-50">
                    <div className={`p-2 rounded-2xl ${alt.color}`}>
                       {alt.icon}
                    </div>
                    <h4 className="font-bold text-slate-800 text-lg tracking-wide">{alt.category}</h4>
                 </div>
                 
                 <div className="grid grid-cols-[auto_1fr] gap-x-4 gap-y-3 text-sm mb-4">
                    <span className="text-[10px] font-black text-teal-600 bg-teal-50 px-2 py-1 rounded-md uppercase tracking-wider self-start mt-0.5 text-center">é¦–é¸</span>
                    <span className="font-bold text-slate-800">{alt.primary}</span>
                    
                    <span className="text-[10px] font-black text-slate-400 bg-slate-100 px-2 py-1 rounded-md uppercase tracking-wider self-start mt-0.5 text-center">æ›¿ä»£</span>
                    <span className="font-medium text-slate-500">{alt.alt}</span>
                 </div>
                 
                 <div className="text-xs text-slate-500 bg-slate-50 p-3 rounded-2xl leading-relaxed border border-slate-100 font-medium">
                    <span className="font-bold text-amber-500 mr-1">ğŸ’¡ NOTE:</span> {alt.note}
                 </div>
              </div>
            ))}
          </div>
        )}

      </div>

      {/* --- CONFIRMATION MODAL --- */}
      {showResetModal && (
        <div className="fixed inset-0 bg-slate-900/60 z-[100] flex items-center justify-center p-6 backdrop-blur-sm animate-fade-in">
            <div className="bg-white rounded-[2rem] p-6 max-w-xs w-full shadow-2xl transform scale-100 transition-all border border-slate-100">
                <div className="text-center mb-6">
                    <div className="bg-rose-100 w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-4">
                        <Repeat className="w-7 h-7 text-rose-500" />
                    </div>
                    <h3 className="text-xl font-extrabold text-slate-800 mb-2 tracking-wide font-rounded">ç¢ºå®šé‡ç½®ï¼Ÿ</h3>
                    <p className="text-slate-500 text-sm leading-relaxed font-medium">
                        é€™å°‡æœƒæ¸…é™¤ä»Šæ—¥æ‰€æœ‰çš„æ”å–ç´€éŒ„ï¼Œæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚
                    </p>
                </div>
                <div className="flex gap-3">
                    <button 
                        onClick={() => setShowResetModal(false)}
                        className="flex-1 py-3.5 rounded-2xl border-2 border-slate-100 text-slate-600 font-bold text-sm hover:bg-slate-50 hover:border-slate-200 transition-all tracking-wide"
                    >
                        å–æ¶ˆ
                    </button>
                    <button 
                        onClick={confirmReset}
                        className="flex-1 py-3.5 rounded-2xl bg-rose-500 text-white font-bold text-sm hover:bg-rose-600 shadow-lg shadow-rose-200 transition-all tracking-wide"
                    >
                        ç¢ºèªé‡ç½®
                    </button>
                </div>
            </div>
        </div>
      )}
    </div>
    </>
  );
};

export default SupplementApp;
